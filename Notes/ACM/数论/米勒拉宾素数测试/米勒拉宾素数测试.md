# 米勒拉宾素数测试

在费马小定理中，若 $gcd(a,p)=1$ 且$p$是素数，则  $a^{(p-1)} ≡ 1 \pmod p$

如果我们想判断 $p$ 是不是素数我们可以通过对 $a$ 随机取值验证式子是否成立

```C++
flag = true;
frs(i,100,flag){
    a = rand(1,p);
    if( a^(p-1)%p!=1 )	flag = false;
}
return flag;
```

```C++
bool isprime(ll p){
    if(p==1||(!p&1))    return false;

    bool flag = true;
    frs(i,100,flag){
        int a = 0;
        while(!a)   a = rand()%p;

        if( qPow(a,p-1,p)!=1 )	flag = false;
    }
    return flag;
}
```

每次满足式子 $a^{p-1} \bmod p==1$则$p$是合数的概率就缩小$1/2$

不满足式子则一定是合数

如果对这个过程重复100次，每次都没说它是合数，那这个数是素数的概率只有$(1/2)^{5100}$可能不是素数